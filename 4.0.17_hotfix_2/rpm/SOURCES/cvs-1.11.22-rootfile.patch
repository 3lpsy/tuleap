--- cvs-1.11.22/src/main.c.old	2006-08-16 16:16:44.265747000 +0200
+++ cvs-1.11.22/src/main.c	2006-08-16 16:21:44.368886000 +0200
@@ -416,6 +416,7 @@
 	{"help-synonyms", 0, NULL, 2},
 	{"help-options", 0, NULL, 4},
 	{"allow-root", required_argument, NULL, 3},
+	{"allow-root-file", required_argument, NULL, 5},
         {0, 0, 0, 0}
     };
     /* `getopt_long' stores the option index here, but right now we
@@ -514,6 +515,11 @@
 		/* --allow-root */
 		root_allow_add (optarg);
 		break;
+	    case 5:
+		/* --allow-root-file */
+		if ( root_allow_add_file(optarg) != 0)
+			exit(1);
+		break;
 	    case 'Q':
 		really_quiet = 1;
 		/* FALL THROUGH */
--- cvs-1.11.22/src/root.c.old	2006-08-16 16:16:12.921095000 +0200
+++ cvs-1.11.22/src/root.c	2006-08-16 16:21:44.387000000 +0200
@@ -222,6 +222,61 @@
     root_allow_vector[root_allow_count++] = p;
 }
 
+int
+root_allow_add_file (fname)
+    char *fname;
+{
+    char *linebuf = NULL;
+    int num_red = 0;
+    size_t linebuf_len = 0;
+    FILE *fp;
+
+    fp = fopen (fname, "r");
+
+    if (fp == NULL)
+    {
+	 if (existence_error (errno))
+	 {
+		 /* The file containing allowed roots cannot open  */
+		 error (0, errno, "cannot open %s", fname);
+		 return(1);
+	 }
+    }
+    else  /* successfully opened allowed root file */
+    {
+         while ((num_red = getline (&linebuf, &linebuf_len, fp)) >= 0)
+         {
+            /* Hmmm, is it worth importing my own readline
+                library into CVS?  It takes care of chopping
+                leading and trailing whitespace, "#" comments, and
+                newlines automatically when so requested.  Would
+                save some code here...  -kff */
+
+             /* Chop newline by hand before passing argument to root_allow_add . */
+             if (linebuf[num_red - 1] == '\n')
+                 linebuf[num_red - 1] = '\0';
+
+	     if (strlen(linebuf)> 0)
+		root_allow_add(linebuf);
+
+         }
+
+	 if (num_red < 0 && !feof (fp)) {
+	    error (0, errno, "cannot read %s", fname);
+	    return(1);
+	 }
+
+	 if (fclose (fp) < 0) {
+	    error (0, errno, "cannot close %s", fname);
+	    return(1);
+	 }
+
+     }
+	
+     return(0);
+}
+
+
 void
 root_allow_free ()
 {
--- cvs-1.11.22/src/root.h.old	2006-08-16 16:16:20.813186000 +0200
+++ cvs-1.11.22/src/root.h	2006-08-16 16:21:44.404212000 +0200
@@ -52,5 +52,6 @@
 cvsroot_t *local_cvsroot PROTO((const char *dir));
 void Create_Root PROTO((const char *dir, const char *rootdir));
 void root_allow_add PROTO ((char *));
+int root_allow_add_file PROTO ((char *));
 void root_allow_free PROTO ((void));
 int root_allow_ok PROTO ((char *));
